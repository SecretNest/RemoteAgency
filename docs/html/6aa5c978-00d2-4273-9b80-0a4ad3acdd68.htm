<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Assembly Requirement</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="6aa5c978-00d2-4273-9b80-0a4ad3acdd68" /><meta name="Description" content="Remote Agency is designed to generate code based on interface provided, and compile the code generated before using it. While compiling, all related assembly should be presented." /><meta name="Microsoft.Help.ContentType" content="How To" /><meta name="BrandingAware" content="true" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Remote Agency<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html\e572b781-93d2-4e52-afb1-8ce06607856b.htm" title="Remote Agency" tocid="roottoc">Remote Agency</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/2fe3f60f-7261-4cb5-826b-b84bfeab6a3e.htm" title="How to" tocid="2fe3f60f-7261-4cb5-826b-b84bfeab6a3e">How to</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/ecc78678-d7a8-41b7-94ce-8743add59236.htm" title="Tutorial" tocid="ecc78678-d7a8-41b7-94ce-8743add59236">Tutorial</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/ae682acd-f05a-4470-a25a-9c19ce4e4d16.htm" title="IO of Manager" tocid="ae682acd-f05a-4470-a25a-9c19ce4e4d16">IO of Manager</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/450e3fa8-d346-49eb-97e6-1a787ddaf694.htm" title="Managing Objects (Proxy and Service Wrapper)" tocid="450e3fa8-d346-49eb-97e6-1a787ddaf694">Managing Objects (Proxy and Service Wrapper)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/3484da6c-de69-4562-8f77-0d2c92b273b6.htm" title="Target Site Management" tocid="3484da6c-de69-4562-8f77-0d2c92b273b6">Target Site Management</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/5c397505-efd8-429a-9ebf-d163295cebbb.htm" title="Disposing Proxy" tocid="5c397505-efd8-429a-9ebf-d163295cebbb">Disposing Proxy</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/6aa5c978-00d2-4273-9b80-0a4ad3acdd68.htm" title="Assembly Requirement" tocid="6aa5c978-00d2-4273-9b80-0a4ad3acdd68">Assembly Requirement</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/626ce0a5-b968-4dab-b5dd-0c73b3c0a5c6.htm" title="Exception Redirect" tocid="626ce0a5-b968-4dab-b5dd-0c73b3c0a5c6">Exception Redirect</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/09cf7238-2b9d-4aff-afaf-949c7734f607.htm" title="Accessing Metadata of Message in Service Method" tocid="09cf7238-2b9d-4aff-afaf-949c7734f607">Accessing Metadata of Message in Service Method</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/c77e5e89-994c-42ee-86ab-addcd4d5ed46.htm" title="Message Filtering" tocid="c77e5e89-994c-42ee-86ab-addcd4d5ed46">Message Filtering</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>Assembly Requirement</h1></td></tr></table><span class="introStyle"></span> <div class="introduction"><p>Remote Agency is designed to generate code based on interface provided, and compile the code generated before using it. While compiling, all related assembly should be presented.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Assembly discovering</span></div><div id="ID0RBSection" class="collapsibleSection"><p>While generating code, Remote Agency is discovering required assemblies at the same time.</p><p>The image of assemblies will be located in order:</p><ol><li><p>From assembly image cache of creator;</p><p>Using the location of the assembly matched by Assembly.Load (dotnet framework) or in TRUSTED_PLATFORM_ASSEMBLIES (dotnet core app); and then,</p><p>Event MissingAssemblyRequesting.</p></li></ol><p>When searching assembly in TRUSTED_PLATFORM_ASSEMBLIES, only assembly (short) name will be used in matching if only one version under this assembly name is included, or full name (including version number) will be taken place.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Additional assembly</span></div><div id="ID1RBSection" class="collapsibleSection"><p>
          If any additional assembly is required while compiling or running the generated code, <a href="991f296f-518c-5922-f2b5-e8c1d83aac08.htm">ImportAssemblyAttribute</a> should be specified on the interface related.
        </p><p>
          The assembly stored in file pointed by <a href="991f296f-518c-5922-f2b5-e8c1d83aac08.htm">ImportAssemblyAttribute</a> will be loaded into assembly image cache and passed to compiler, no matter it is required while compiling or not.
        </p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Assembly image cache</span></div><div id="ID2RBSection" class="collapsibleSection"><p>
          Each instance of creator (proxy creator and service wrapper creator) has a cache to store images of all loaded assembly. The image can be loaded into cache from assembly discovering process including event MissingAssemblyRequesting, as well as through <a href="991f296f-518c-5922-f2b5-e8c1d83aac08.htm">ImportAssemblyAttribute</a>. These cached assembly will not be asked to provide again through event MissingAssemblyRequesting.
        </p><p>To clean the cache, call ClearBuilderAssemblyCache or use another instance of creator.</p><ul><li><p>Proxy Creator: <a href="e3e38d59-4090-4447-6b53-1df4306816e4.htm">ClearBuilderAssemblyCache</a></p></li><li><p>Service Wrapper Creator: <a href="877e8d78-cdcf-5546-85e9-cb021c219577.htm">ClearBuilderAssemblyCache</a></p></li><li><p>SecretNest.RemoteAgency.DataContractSerializer.EasyEncapsulation.RemoteAgencyManagerEncapsulated: <a href="e0966652-4785-e0aa-ddd1-86bff4d2a5e8.htm">ClearBuilderAssemblyCache</a></p></li></ul></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Event MissingAssemblyRequesting</span></div><div id="ID3RBSection" class="collapsibleSection"><p>When an assembly required cannot be located, or the located assembly doesn't contain the value of the file location (in memory generated for example), the event MissingAssemblyRequesting will be raised for asking the image of the assembly file.</p><p>This event is defined in creator (proxy creator and service wrapper creator) and should be exposed by any class which contains a creator, such as manager class in EasyEncapsulation.</p><p>This event contains an argument with type <a href="60145561-5dbb-930c-35ea-887f795197ea.htm">AssemblyRequestingEventArgs</a>. The event handler should load the image of the assembly specified and call the method <a href="431ebee0-b219-638f-d579-e527003d0d22.htm">Load</a> from the argument.</p><p>This is the final chance to fix the assembly missing problem. If the event handler is missing, or method Load is not called before returning, compiling will not be finished successfully.</p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID4RBSection" class="collapsibleSection"><h4 class="subHeading">Other Resources</h4><div class="seeAlsoStyle"><a href="ecc78678-d7a8-41b7-94ce-8743add59236.htm">Tutorial</a></div></div></div></div><div id="pageFooter" class="pageFooter" /></body></html>