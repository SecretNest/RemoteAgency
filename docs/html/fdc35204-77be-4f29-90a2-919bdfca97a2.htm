<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Disposing</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="fdc35204-77be-4f29-90a2-919bdfca97a2" /><meta name="Description" content="In some case, proxy and service wrapper objects need disposing." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Remote Agency<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/e572b781-93d2-4e52-afb1-8ce06607856b.htm" title="Remote Agency" tocid="roottoc">Remote Agency</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/2fe3f60f-7261-4cb5-826b-b84bfeab6a3e.htm" title="How to" tocid="2fe3f60f-7261-4cb5-826b-b84bfeab6a3e">How to</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/ecc78678-d7a8-41b7-94ce-8743add59236.htm" title="Tutorial" tocid="ecc78678-d7a8-41b7-94ce-8743add59236">Tutorial</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/c84610d8-63f7-48b7-aa35-3a66c03859a1.htm" title="Example: Use Remote Agency" tocid="c84610d8-63f7-48b7-aa35-3a66c03859a1">Example: Use Remote Agency</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/0a431cb5-f6dc-4fa3-ae88-33e70d7c8442.htm" title="Develop a serializer" tocid="0a431cb5-f6dc-4fa3-ae88-33e70d7c8442">Develop a serializer</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/fdc35204-77be-4f29-90a2-919bdfca97a2.htm" title="Disposing" tocid="fdc35204-77be-4f29-90a2-919bdfca97a2">Disposing</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/162ef05d-ab9f-49e0-ad56-2ed045f7aae0.htm" title="Handle network transportations" tocid="162ef05d-ab9f-49e0-ad56-2ed045f7aae0">Handle network transportations</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>Disposing</h1></td></tr></table><span class="introStyle"></span> <div class="introduction"><p>In some case, proxy and service wrapper objects need disposing.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Disposing requirement</span></div><div id="ID0RBSection" class="collapsibleSection"><p>When proxy or service wrapper is created from creator, the out parameter named disposeRequired indicates whether disposing is required on this object. This will be set to true only when event is found in service contract interfaces.</p><p>When a proxy is specified as disposing required, but no event is handled (subscribing, not executing) yet, the disposing is not necessary.</p><p>When proxy or service wrapper is generated from RemoteAgencyManager and its derived classes, disposing will be handled automatically.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Reason of disposing proxy</span></div><div id="ID1RBSection" class="collapsibleSection"><p>After an event is subscribed on a proxy, the site id, instance id and event asset will be registered on the target service wrapper object. These information will be removed while proxy object disposing. That's also the reason why a message need to be sent to remote side when a proxy is disposing at local.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Reason of disposing service wrapper</span></div><div id="ID2RBSection" class="collapsibleSection"><p>After an event is subscribed on a proxy, a handler is attached to service object well. The disposing process of service wrapper, includes the removal of attached handler from service object.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />To dispose</span></div><div id="ID4RBSection" class="collapsibleSection"><p>To dispose an object of proxy or service wrapper, cast it into IDisposable and call the dispose method on it.</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID3EAAABAAA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID3EAAABAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID3EAAABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID3EAAABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">((IDisposable)obj).Dispose();</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID3EAAABAAA");</script></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID5RB')" onkeypress="SectionExpandCollapse_CheckKey('ID5RB', event)" tabindex="0"><img id="ID5RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID5RBSection" class="collapsibleSection"><h4 class="subHeading">Other Resources</h4><div class="seeAlsoStyle"><a href="0a431cb5-f6dc-4fa3-ae88-33e70d7c8442.htm">Develop a serializer</a></div></div></div></div><div id="pageFooter" class="pageFooter" /></body></html>