<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tutorial</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="ecc78678-d7a8-41b7-94ce-8743add59236" /><meta name="Description" content="Remote Agency is built for making the communicating among components in different computers easier." /><meta name="Microsoft.Help.ContentType" content="How To" /><meta name="BrandingAware" content="true" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Remote Agency<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/e572b781-93d2-4e52-afb1-8ce06607856b.htm" title="Remote Agency" tocid="roottoc">Remote Agency</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/2fe3f60f-7261-4cb5-826b-b84bfeab6a3e.htm" title="How to" tocid="2fe3f60f-7261-4cb5-826b-b84bfeab6a3e">How to</a></div><div class="toclevel1 current" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/ecc78678-d7a8-41b7-94ce-8743add59236.htm" title="Tutorial" tocid="ecc78678-d7a8-41b7-94ce-8743add59236">Tutorial</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/ae682acd-f05a-4470-a25a-9c19ce4e4d16.htm" title="IO of Manager" tocid="ae682acd-f05a-4470-a25a-9c19ce4e4d16">IO of Manager</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/450e3fa8-d346-49eb-97e6-1a787ddaf694.htm" title="Managing Objects (Proxy and Service Wrapper)" tocid="450e3fa8-d346-49eb-97e6-1a787ddaf694">Managing Objects (Proxy and Service Wrapper)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/3484da6c-de69-4562-8f77-0d2c92b273b6.htm" title="Target Site Management" tocid="3484da6c-de69-4562-8f77-0d2c92b273b6">Target Site Management</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/5c397505-efd8-429a-9ebf-d163295cebbb.htm" title="Disposing Proxy" tocid="5c397505-efd8-429a-9ebf-d163295cebbb">Disposing Proxy</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/6aa5c978-00d2-4273-9b80-0a4ad3acdd68.htm" title="Assembly Requirement" tocid="6aa5c978-00d2-4273-9b80-0a4ad3acdd68">Assembly Requirement</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/626ce0a5-b968-4dab-b5dd-0c73b3c0a5c6.htm" title="Exception Redirect" tocid="626ce0a5-b968-4dab-b5dd-0c73b3c0a5c6">Exception Redirect</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/09cf7238-2b9d-4aff-afaf-949c7734f607.htm" title="Accessing Metadata of Message in Service Method" tocid="09cf7238-2b9d-4aff-afaf-949c7734f607">Accessing Metadata of Message in Service Method</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/c77e5e89-994c-42ee-86ab-addcd4d5ed46.htm" title="Message Filtering" tocid="c77e5e89-994c-42ee-86ab-addcd4d5ed46">Message Filtering</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>Tutorial</h1></td></tr></table><span class="introStyle"></span> <div class="introduction"><p>Remote Agency is built for making the communicating among components in different computers easier.</p><p>Remote Agency can create proxy objects based on one interface file which should be implemented by a remote class, and serializing the accessing between the proxy and the real service object.</p><p>This tutorial will help you to understand the structure of Remote Agency and how to use it in your own code.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Package structure</span></div><div id="ID0RBSection" class="collapsibleSection"><p>To use Remote Agency, you need to add package SecretNest.RemoteAgency from NuGet to your project. This library includes the proxy and service wrapper creating code and the management functions for created objects.</p><p>Also, you need a derived solution for serializing support. You can get a finished product, like SecretNest.RemoteAgency.DataContractSerializer, or make your own one.</p><p>You may find a encapsulated solution, like SecretNest.RemoteAgency.DataContractSerializer.EasyEncapsulataion, which embedded Remote Agency and a serializer. It's a good choice for make your code easy and clean.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Concept</span></div><div id="ID1RBSection" class="collapsibleSection"><ul><li><p>Site</p><p>A site is a collection of functional objects. In a generic solution, every instance of an executable program can be a site. Usually, in a C/S module, we can treat every client and server program as a site.</p></li><li><p>Service Contract Interface</p><p>An interface which contains the operations which are exposed by the service object to the outside.</p></li><li><p>Proxy</p><p>For example, when your code call a method in a real object, you need to write down the method name. Now because the real object is far away from your site, it's not possible to call it directly.</p><p>A proxy object generated by Remote Agency based on the service contract interface helps your code accessing and implement the remote calling.</p></li><li><p>Service Wrapper</p><p>A wrapper object that wrap your real service object, in order to replay the calling from the proxy.</p></li><li><p>Remote Agency Manager</p><p>A manager of created proxy and service wrapper objects, handling the message packing.</p></li><li><p>Asset</p><p>In Remote Agency, asset means each method, event and property in a service contract interface.</p></li><li><p>Entity</p><p>In Remote Agency, entity means the object of entity class contains parameters, return and some special request commands.</p></li><li><p>Message</p><p>In Remote Agency, message means a packed datagram that should be transport from a site to another.</p></li><li><p>Transport</p><p>In Remote Agency, transport means to deliver messages among manager objects belongs to all sites.</p></li><li><p>Generic Types</p><p>When using Remote Agency, you will facing several generic types.</p><ul class="noBullet"><li><p>TNetworkMessage: Type of the message for transporting. In Data Contract Serializer, this is string (in json format).</p></li><li><p>TSerialized: Type of the serialized data. In Data Contract Serializer, this is string.</p></li><li><p>TEntityBase: Type of the parent class of all entities. In Data Contract Serializer, this is object.</p></li><li><p>TInterfaceContract: Type of the service contract interface.</p></li><li><p>TServiceObject: Type of the class of the service object.</p></li></ul></li></ul></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Start to use</span></div><div id="ID2RBSection" class="collapsibleSection"><p>It's simple.</p><p>First, you need to create an instance of Remote Agency Manager or it's derived for each site.</p><p>Then, handle the <a href="1887b9d3-4692-2c2e-d054-1d386d9e1797.htm">MessageForSendingPrepared</a> to make them connected.</p><p>Third, create objects of proxy and service wrapper, and put them into the manager of their site.</p><p>Now, you can use the proxy as the original way to access the server side object.</p><p>Remove objects from manager when not used any more. Don't forget to disposing the objects when necessary, if you create them by creator own.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remote Agency Manager</span></div><div id="ID3RBSection" class="collapsibleSection"><p>Let's check some key points of Remote Agency Manager.</p><p>Site id: Every manager instance has a site id in Guid format, which is used to identify the instance. If this is not specified while constructing, a randomized value will be used.</p><p>Context id: An id of the IO context. Every time the IO status changed, the context id will be changed also. You can change it manually by using <a href="3f3251a7-ac6b-9976-2e54-741e175ae93d.htm">ResetContextId(Guid)</a> or <a href="5d9dfc0b-1111-256d-a76c-0080cbed6eef.htm">ResetContextId<span id="LST9BD4A35C_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST9BD4A35C_0?cs=()|vb=|cpp=()|nu=()|fs=()");</script></a>.</p><p>IO related members: Please refer to <a href="ae682acd-f05a-4470-a25a-9c19ce4e4d16.htm">IO of Manager</a>.</p><p>Adding and removing proxy and service wrapper objects: Please refer to <a href="450e3fa8-d346-49eb-97e6-1a787ddaf694.htm">Managing Objects (Proxy and Service Wrapper)</a>.</p><p>Target site management: Please refer to Please refer to <a href="3484da6c-de69-4562-8f77-0d2c92b273b6.htm">Target Site Management</a>.</p><p>Dealing with the proxy objects with disposing required: Please refer to <a href="5c397505-efd8-429a-9ebf-d163295cebbb.htm">Disposing Proxy</a>.</p><p>Exception redirect: Please refer to <a href="626ce0a5-b968-4dab-b5dd-0c73b3c0a5c6.htm">Exception Redirect</a>.</p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID4RBSection" class="collapsibleSection"><h4 class="subHeading">Other Resources</h4><div class="seeAlsoStyle"><a href="c84610d8-63f7-48b7-aa35-3a66c03859a1.htm">Example: Use Remote Agency</a></div></div></div></div><div id="pageFooter" class="pageFooter" /></body></html>