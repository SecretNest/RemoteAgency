<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>10: Attributes Pass-Through</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="9d138999-0ebe-4bd8-90d5-0b84f2000a0a" /><meta name="Description" content="When attributes should be marked on the proxy being created by Remote Agency, the information should be specified by T:SecretNest.RemoteAgency.Attributes.AttributePassThroughAttribute, T:SecretNest.RemoteAgency.Attributes." /><meta name="Microsoft.Help.ContentType" content="How To" /><meta name="BrandingAware" content="true" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.5.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Remote Agency</div><div class="pageBody"><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>10: Attributes Pass-Through</h1></td></tr></table><span class="introStyle"></span> <div class="introduction">
  <p>When attributes should be marked on the proxy being created by Remote Agency, the information should be specified by <a href="T_SecretNest_RemoteAgency_Attributes_AttributePassThroughAttribute.htm">AttributePassThroughAttribute</a>, <a href="T_SecretNest_RemoteAgency_Attributes_AttributePassThroughIndexBasedParameterAttribute.htm">AttributePassThroughIndexBasedParameterAttribute</a>, <a href="T_SecretNest_RemoteAgency_Attributes_AttributePassThroughPropertyAttribute.htm">AttributePassThroughPropertyAttribute</a> and <a href="T_SecretNest_RemoteAgency_Attributes_AttributePassThroughFieldAttribute.htm">AttributePassThroughFieldAttribute</a> on interface and its assets.</p>
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Prerequisites</span></div><div id="ID0RBSection" class="collapsibleSection">
  Before using this example code, an app need to be created first. Follow <a href="59115d8d-60b6-4dcb-81ba-465d85cc1260.htm">this doc</a> to prepare that first.
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Brief</span></div><div id="ID1RBSection" class="collapsibleSection"><p>When an attribute is required on the proxy being created, follow these steps:</p>
<ol><li>
    <p>Marking <a href="T_SecretNest_RemoteAgency_Attributes_AttributePassThroughAttribute.htm">AttributePassThroughAttribute</a> on the asset which requires the attribute. Event, method, property, parameter, generic parameter, return value and interface are supported.</p>
    <p>When a constructor with parameters should be used, specify all types of parameters in attributeConstructorParameterTypes.</p>
    <p>When parameters of constructor can be provided in order, specify them in attributeConstructorParameters. The length of parameters cannot exceed the length of attributeConstructorParameterTypes. When this is shorter, the missing parameters will be filled by <span class="code">null</span> / <span class="code">Nothing</span>.</p>
    <p>When additional information need to be provided, attributeId should to be set with a unique string, which is the same as the AttributeId of the attributes providing additional information.</p>
  </li><li>
    <p>Marking <a href="T_SecretNest_RemoteAgency_Attributes_AttributePassThroughIndexBasedParameterAttribute.htm">AttributePassThroughIndexBasedParameterAttribute</a> on the asset with the same attributeId to pass additional parameter to the constructor. Parameter parameterIndex cannot be negative, equal or larger than the length of the parameters of the constructor. Name of the parameter should be specified by index of the parameter due to lack of parameter name list.</p>
    <p>When multiple parameters are required, specify one at a time.</p>
  </li><li>
    <p>Marking <a href="T_SecretNest_RemoteAgency_Attributes_AttributePassThroughPropertyAttribute.htm">AttributePassThroughPropertyAttribute</a> on the asset with the same attributeId when some property need to be set. The property pointed by propertyName should be settable publicly.</p>
    <p>Parameter order can be adjust when setting order needs to be guaranteed. The property with smaller order number will be set first. Default value is 0.</p>
    <p>When multiple properties are required to be set, specify one at a time.</p>
  </li><li>
    <p>Marking <a href="T_SecretNest_RemoteAgency_Attributes_AttributePassThroughFieldAttribute.htm">AttributePassThroughFieldAttribute</a> on the asset with the same attributeId when some field need to be set. The field pointed by fieldName should be settable publicly.</p>
    <p>Parameter order can be adjust when setting order needs to be guaranteed. The field with smaller order number will be set first. Default value is 0.</p>
    <p>When multiple fields are required to be set, specify one at a time.</p>
  </li></ol>
<p>The setting order between properties and fields are controlled by dotnet runtime.</p>
<p>When multiple attributes are required, specify each of them using the steps above.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Steps</span></div><div id="ID3RBSection" class="collapsibleSection"><div class="subSection"><ol><li><p>Create an attribute to be used in proxy.</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID2EBAAADAAABAAA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID2EBAAADAAABAAA','cs','1','2');return false;">C#</a></div><div id="ID2EBAAADAAABAAA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID2EBAAADAAABAAA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID2EBAAADAAABAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID2EBAAADAAABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID2EBAAADAAABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">[AttributeUsage(AttributeTargets.Method)]
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">sealed</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">class</span> MyOwnAttribute : Attribute
{
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span> MyProperty { <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">get</span>; <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">set</span>; }
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> MyField;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span> AFromCtor { <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">get</span>; }
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> BFromCtor { <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">get</span>; } 
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">bool</span> CFromCtor { <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">get</span>; }

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> MyOwnAttribute(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span> a, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span> b = 0, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">bool</span> c = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">false</span>)
    {
        AFromCtor = a;
        BFromCtor = b;
        CFromCtor = c;
    }
}</pre></div><div id="ID2EBAAADAAABAAA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve">&lt;AttributeUsage(AttributeTargets.Method)&gt;
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">NotInheritable</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Class</span> MyOwnAttribute
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Inherits</span> Attribute
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Property</span> MyProperty <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> MyField <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">ReadOnly</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Property</span> AFromCtor <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">ReadOnly</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Property</span> BFromCtor <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">ReadOnly</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Property</span> CFromCtor <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Boolean</span>

    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span>(a <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Optional</span> b <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span> = 0, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Optional</span> c <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">As</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Boolean</span> = <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">False</span>)
        AFromCtor = a
        BFromCtor = b
        CFromCtor = c
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Class</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID2EBAAADAAABAAA");</script></li><li><p>Create an interface that contains the asset with attribute pass-through behavior specified.</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID2EBAAACAAABAAA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID2EBAAACAAABAAA','cs','1','2');return false;">C#</a></div><div id="ID2EBAAACAAABAAA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID2EBAAACAAABAAA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID2EBAAACAAABAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID2EBAAACAAABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID2EBAAACAAABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">interface</span> ITest10
{
    [AttributePassThrough(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">typeof</span>(MyOwnAttribute),
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span>[] {<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">typeof</span>(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">string</span>), <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">typeof</span>(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">int</span>), <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">typeof</span>(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">bool</span>)},
        <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">new</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">object</span>[] {<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ValueOfA"</span>},
        <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ThisIsMyMethod"</span>)]
    [AttributePassThroughIndexBasedParameter(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ThisIsMyMethod"</span>, 2, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">true</span>)]
    [AttributePassThroughProperty(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ThisIsMyMethod"</span>, nameof(MyOwnAttribute.MyProperty), <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"PropertyValue"</span>)]
    [AttributePassThroughField(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ThisIsMyMethod"</span>, nameof(MyOwnAttribute.MyField), 123)]
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> MyMethod();
}</pre></div><div id="ID2EBAAACAAABAAA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Interface</span> ITest10
    &lt;AttributePassThrough(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">GetType</span>(MyOwnAttribute), <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> Type() {<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">GetType</span>(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">String</span>), <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">GetType</span>(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Integer</span>), <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">GetType</span>(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Boolean</span>)}, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">New</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Object</span>() {<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ValueOfA"</span>}, <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ThisIsMyMethod"</span>)&gt;
    &lt;AttributePassThroughIndexBasedParameter(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ThisIsMyMethod"</span>, 2, <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">True</span>)&gt;
    &lt;AttributePassThroughProperty(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ThisIsMyMethod"</span>, NameOf(MyOwnAttribute.MyProperty), <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"PropertyValue"</span>)&gt;
    &lt;AttributePassThroughField(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ThisIsMyMethod"</span>, NameOf(MyOwnAttribute.MyField), 123)&gt;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> MyMethod()
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Interface</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID2EBAAACAAABAAA");</script></li><li><p>Place this code to a method, <span class="code">main</span> method for example.</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID2EBAAABAAABAAA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID2EBAAABAAABAAA','cs','1','2');return false;">C#</a></div><div id="ID2EBAAABAAABAAA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID2EBAAABAAABAAA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID2EBAAABAAABAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID2EBAAABAAABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID2EBAAABAAABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">//Create a remote agency instance without target for creating proxy class only.</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">using</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> remoteAgencyInstance = RemoteAgencyBase.CreateWithBinarySerializer(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">true</span>);
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> clientProxy = remoteAgencyInstance.CreateProxy&lt;ITest10&gt;(Guid.Empty, Guid.Empty).ProxyGeneric;

Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Getting attribute..."</span>);
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> proxyClassType = clientProxy.GetType();
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> myMethod = proxyClassType.GetMethod(nameof(ITest10.MyMethod));
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">var</span> myAttribute = myMethod!.GetCustomAttribute&lt;MyOwnAttribute&gt;();
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">if</span> (myAttribute == <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">null</span>)
{
    Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Houston, we have a problem."</span>);
}
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">else</span>
{
    Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Here are attribute values:"</span>);
    Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"  MyProperty: (PropertyValue): {0}"</span>, myAttribute.MyProperty);
    Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"  MyField: (123): {0}"</span>, myAttribute.MyField);
    Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"  AFromCtor: (ValueOfA): {0}"</span>, myAttribute.AFromCtor);
    Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"  BFromCtor: (0): {0}"</span>, myAttribute.BFromCtor);
    Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"  CFromCtor: (true): {0}"</span>, myAttribute.CFromCtor);
}

Console.Write(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Press any key to continue..."</span>);
Console.ReadKey(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">true</span>);
Console.WriteLine();</pre></div><div id="ID2EBAAABAAABAAA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">'Create a remote agency instance without target for creating proxy class only.</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> remoteAgencyInstance = RemoteAgencyBase.CreateWithBinarySerializer(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">True</span>)
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> clientProxy = remoteAgencyInstance.CreateProxy(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> ITest10)(Guid.Empty, Guid.Empty).ProxyGeneric

Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Getting attribute..."</span>)
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> proxyClassType = clientProxy.<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">GetType</span>()
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> myMethod = proxyClassType.GetMethod(NameOf(ITest10.MyMethod))
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Dim</span> myAttribute = myMethod.GetCustomAttribute(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Of</span> MyOwnAttribute)()
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span> (myAttribute <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Is</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Nothing</span>) <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Then</span>
    Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Houston, we have a problem."</span>)
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Else</span>
    Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Here are attribute values:"</span>)
    Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"  MyProperty: (PropertyValue): {0}"</span>, myAttribute.MyProperty)
    Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"  MyField: (123): {0}"</span>, myAttribute.MyField)
    Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"  AFromCtor: (ValueOfA): {0}"</span>, myAttribute.AFromCtor)
    Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"  BFromCtor: (0): {0}"</span>, myAttribute.BFromCtor)
    Console.WriteLine(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"  CFromCtor: (true): {0}"</span>, myAttribute.CFromCtor)
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">If</span>

Console.Write(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"Press any key to continue..."</span>)
Console.ReadKey(<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">True</span>)
Console.WriteLine()

remoteAgencyInstance.Dispose()</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID2EBAAABAAABAAA");</script></li><li><p>Run the example.</p><p>Proxy class will be created in memory like this:</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID2EBAAAAAAABAAA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID2EBAAAAAAABAAA','cs','1','2');return false;">C#</a></div><div id="ID2EBAAAAAAABAAA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID2EBAAAAAAABAAA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID2EBAAAAAAABAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID2EBAAAAAAABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID2EBAAAAAAABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">class</span> MyService_Proxy : IMyService
{
    [MyOwn(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ValueOfA"</span>, c: <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">true</span>, MyProperty = <span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"PropertyValue"</span>, MyField = 123)]
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">void</span> MyMethod()
    {
        <span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">//...</span>
    }
}</pre></div><div id="ID2EBAAAAAAABAAA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Class</span> MyService_Proxy
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Implements</span> IMyService

    &lt;MyOwn(<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"ValueOfA"</span>, , <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">True</span>, MyProperty:=<span class="literal" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">"PropertyValue"</span>, MyField:=123)&gt;
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Public</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span> MyMethod() <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Implements</span> IMyService.MyMethod
<span class="comment" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">        '...</span>
    <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Sub</span>
<span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">End</span> <span class="keyword" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Class</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID2EBAAAAAAABAAA");</script></li></ol></div></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID4RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="M_SecretNest_RemoteAgency_RemoteAgency_2_CreateProxy__1_1.htm">CreateProxy<span id="LSTC4A2245E_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTC4A2245E_0?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script>TInterface<span id="LSTC4A2245E_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTC4A2245E_1?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script></a></div><h4 class="subHeading">Other Resources</h4><div class="seeAlsoStyle"><a href="1e4e6ad4-f0b5-4925-9a9f-4e2704e27d6a.htm">Examples</a></div><div class="seeAlsoStyle"><a href="0276dae1-94a2-4e9c-87ab-e3b371f41104.htm">Attributes Pass-Through</a></div></div></div></div><div id="pageFooter" class="pageFooter" /></body></html>