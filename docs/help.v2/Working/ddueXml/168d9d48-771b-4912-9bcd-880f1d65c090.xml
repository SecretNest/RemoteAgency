<?xml version="1.0" encoding="utf-8"?>
<topic id="168d9d48-771b-4912-9bcd-880f1d65c090" revisionNumber="1">
  <developerConceptualDocument
    xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"
    xmlns:xlink="http://www.w3.org/1999/xlink">

    <introduction>
      <para>By default, the parameters and return value will be passed between sites like value type.</para>
      <para>Due to lack of tracking, the value inside reference type changed by another site cannot be synced back automatically. After accessing the remote site, the parameter marked by "ref / ByRef" or "out / Out" will be replaced by the instance from the remote site.</para>
      <para>No return value or output parameters will be set if exception thrown while accessing on the remote site.</para>
    </introduction>

    <section address="Ignore">
      <title>Ignoring</title>
      <content>
        <para>Marking <codeEntityReference qualifyHint="false">T:SecretNest.RemoteAgency.Attributes.ParameterIgnoredAttribute</codeEntityReference> on the parameter will avoid the value from transmitting. It’s usually used for optimized entity by removing the parameter not being used by remote site, like the sender in event arguments.</para>
        <para>Marking <codeEntityReference qualifyHint="false">T:SecretNest.RemoteAgency.Attributes.ReturnIgnoredAttribute</codeEntityReference> on the asset will avoid the result value from transmitting. It should be noted that this attribute only affects the transmission of the return value. Exception and two-way parameters are not affected.</para>
      </content>
    </section>

    <section address="TwoWay">
      <title>Two-way</title>
      <content>
        <para><codeEntityReference qualifyHint="false">T:SecretNest.RemoteAgency.Attributes.ParameterReturnRequiredAttribute</codeEntityReference> can only be set on the parameter marked by "ref / ByRef" or "out / Out", adjusting whether the returning is required which is enabled by default, property name in entity and whether should be included while exception is thrown on the remote site which is disabled by default.</para>
        <para><codeEntityReference qualifyHint="false">T:SecretNest.RemoteAgency.Attributes.ParameterReturnRequiredPropertyAttribute</codeEntityReference> can only be set on the parameter without "ref / ByRef" and "out / Out", adjusting what property or field of this parameters should be sent back to the caller as well as whether the returning is required which is enabled by default, property name in entity and whether should be included while exception is thrown on the remote site which is disabled by default.</para>
        <para>When multiple properties or fields need to be specified, marks them one by one, or use a helper class instead. Helper class is also used for handling some special operation coded by developer. When helper class is preferred, marks the parameter by <codeEntityReference qualifyHint="false">T:SecretNest.RemoteAgency.Attributes.ParameterReturnRequiredPropertyAttribute</codeEntityReference> with helper class specified. There should be a publicly accessible constructor with one parameter in the helper class. The type of the parameter should be the same as the marked parameter. In the helper class, each property marked with <codeEntityReference qualifyHint="false">T:SecretNest.RemoteAgency.Attributes.ReturnRequiredPropertyHelperAttribute</codeEntityReference> will be processed. Each property should have both get and set method publicly accessible.</para>
        <para>The property specified will be read immediately after accessing asset. Only changes that occur within the asset (body of the method being called for example) will be guaranteed to be sent back.</para>
        <para><codeEntityReference qualifyHint="false">T:SecretNest.RemoteAgency.Attributes.ParameterReturnRequiredPropertyAttribute</codeEntityReference> can be marked on property also, which only affects set operating.</para>
        <para>Check <link xlink:href="e0c354d3-50df-45a7-a19f-8053f4a4b52a" >this example</link> for reference.</para>
      </content>
    </section>

    <section address="Event">
      <title>Event</title>
      <content>
        <para>When using these attributes on events, specifies those on the delegate of the event handler. Or, use <codeEntityReference qualifyHint="false">T:SecretNest.RemoteAgency.Attributes.EventParameterIgnoredAttribute</codeEntityReference>, <codeEntityReference qualifyHint="false">T:SecretNest.RemoteAgency.Attributes.EventParameterReturnRequiredAttribute</codeEntityReference> and <codeEntityReference qualifyHint="false">T:SecretNest.RemoteAgency.Attributes.EventParameterReturnRequiredPropertyAttribute</codeEntityReference> on the event instead which have higher priority than those on delegate.</para>
      </content>
    </section>

    <relatedTopics>
      <codeEntityReference linkText="All attributes">N:SecretNest.RemoteAgency.Attributes</codeEntityReference>
      <link xlink:href="14c3caef-7392-4f68-b7eb-d0bb014a2e4c">Attributes</link>
      <link xlink:href="e0c354d3-50df-45a7-a19f-8053f4a4b52a">Example 2: Method Parameter Ignored and Two-way</link>
      <link xlink:href="1546aac8-8553-468e-8cc6-f3f2cefb6784">Example 5: Property and Generic Interface</link>
      <link xlink:href="ddf8c107-d1ad-4e41-b851-1ab542686164">Example 6: Indexer</link>
      <link xlink:href="3fce1b5d-997f-4caa-9239-73257e7d6abe">Example 9: Event One-way, Ignored, Local Exception Handling and Timeout, Parameter Ignored and Two-way</link>
    </relatedTopics>
  </developerConceptualDocument>
</topic>
