<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Thread Lock</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="3c648b23-25dd-454c-b074-d0f3f0a0958c" /><meta name="Description" content="By default, Remote Agency access asset specified using the same thread of processing received message. When messages come from different threads, the assets in target service object should be thread safe for being called from multiple threads." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.5.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Remote Agency<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/54b2e0fb-7a41-44f2-8800-831e473db023.htm" title="Remote Agency" tocid="roottoc">Remote Agency</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/2d36d4de-5cb0-4111-8a43-96b3b90d5f61.htm" title="Tunings" tocid="2d36d4de-5cb0-4111-8a43-96b3b90d5f61">Tunings</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/e7b65736-b2df-4aa9-897a-3a3050d3cceb.htm" title="Asset Ignoring, Timeout and One-way" tocid="e7b65736-b2df-4aa9-897a-3a3050d3cceb">Asset Ignoring, Timeout and One-way</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/168d9d48-771b-4912-9bcd-880f1d65c090.htm" title="Parameter Ignoring and Two-way" tocid="168d9d48-771b-4912-9bcd-880f1d65c090">Parameter Ignoring and Two-way</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/5e4cbd69-ed6d-4b66-8496-4925ae64b4c7.htm" title="Local Exception Handling" tocid="5e4cbd69-ed6d-4b66-8496-4925ae64b4c7">Local Exception Handling</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/beb637a2-3887-49ff-93f3-1f71b095aa7e.htm" title="Name Customizing" tocid="beb637a2-3887-49ff-93f3-1f71b095aa7e">Name Customizing</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/b6910a74-dde5-4d20-ac0d-4fb1231cea87.htm" title="Async Method" tocid="b6910a74-dde5-4d20-ac0d-4fb1231cea87">Async Method</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/3c648b23-25dd-454c-b074-d0f3f0a0958c.htm" title="Thread Lock" tocid="3c648b23-25dd-454c-b074-d0f3f0a0958c">Thread Lock</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>Thread Lock</h1></td></tr></table><span class="introStyle"></span> <div class="introduction"><p>By default, Remote Agency access asset specified using the same thread of processing received message. When messages come from different threads, the assets in target service object should be thread safe for being called from multiple threads.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Mode</span></div><div id="ID0RBSection" class="collapsibleSection"><p>When tuning required, <a href="T_SecretNest_RemoteAgency_Attributes_ThreadLockAttribute.htm">ThreadLockAttribute</a> can be marked on interface with 4 modes.</p><ul class="noBullet"><li><p>None: Default value. The same as when ThreadLockAttribute absents.</p></li><li><p>SynchronizationContext: Always use Synchronization Context for accessing assets.</p></li><li><p>AnyButSameThread: Within each object (service wrapper and proxy), asset access will be restricted to a single thread. This is not supported by neat version of Remote Agency due to lack of built-in SequentialScheduler.</p></li><li><p>TaskSchedulerSpecified: Tasks for accessing assets related to this interface will be started from a Task Scheduler specified by name. The name is passed by ThreadLockAttribute(string taskSchedulerName). Before processing this interface, the instance of Task Scheduler should be added to the instance of Remote Agency by <a href="M_SecretNest_RemoteAgency_RemoteAgencyBase_TryAddTaskScheduler.htm">TryAddTaskScheduler</a>. <a href="M_SecretNest_RemoteAgency_RemoteAgencyBase_TryGetTaskScheduler.htm">TryGetTaskScheduler</a> and <a href="M_SecretNest_RemoteAgency_RemoteAgencyBase_TryRemoveTaskScheduler.htm">TryRemoveTaskScheduler</a> can help manage added schedulers.</p></li></ul></div><div class="collapsibleAreaRegion" id="SynchronizationContext"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Synchronization Context</span></div><div id="ID1RBSection" class="collapsibleSection"><p>The task factory based on synchronization context is stored at <a href="P_SecretNest_RemoteAgency_RemoteAgencyBase_SynchronizationContextTaskFactory.htm">SynchronizationContextTaskFactory</a>. This is a static property. When required, the task factory specified is used. If the value is null / Nothing, an instance of task factory based on synchronization context is created from the current thread.</p><p>Due to the limitation of dotnet core and dotnet 5, synchronization context may not be obtained in any thread. This may cause an exception thrown while trying to create the task factory base on it. To avoid it, always set the value manually in UI thread, like in Form_Load method. To simplify the operation, call <a href="M_SecretNest_RemoteAgency_RemoteAgencyBase_CreateSynchronizationContextTaskFactoryFromCurrentThread.htm">CreateSynchronizationContextTaskFactoryFromCurrentThread</a> in UI thread.</p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="N_SecretNest_RemoteAgency_Attributes.htm">All attributes</a></div><h4 class="subHeading">Other Resources</h4><div class="seeAlsoStyle"><a href="14c3caef-7392-4f68-b7eb-d0bb014a2e4c.htm">Attributes</a></div></div></div></div><div id="pageFooter" class="pageFooter" /></body></html>